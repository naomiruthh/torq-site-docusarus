<!-- ## Metadata_Start
## title: Troubleshoot a self-hosted step runner
## original-url : https://learn.torq.io/docs/troubleshoot-self-hosted-step-runner
## article-id : 3ff0f2f4-df1f-4ba4-885d-91a40aeb7ce1
## seo-title : How to troubleshoot a self-hosted step runner in Torq
## description : Host Torq's cyber security steps on a self-hosted runner. 
## category-type : html
## Metadata_End -->
<p>When a step that is run by a self-hosted step runner fails you should verify the connectivity between the runner and the Torq cloud as well as the internal connectivity between the runner and the end user app. Follow the suggestions below to get more information so you can understand what the problem is or have more information when contacting support.</p><h2>Analyze the error message</h2><p>Check the error in the step <strong>Execution Log</strong>.</p><ul><li><strong>&nbsp;</strong>The error<strong>&nbsp;</strong>might indicate a problem with the connectivity between the runner and the Torq cloud.</li></ul><p><img src="https://cdn.document360.io/e159bc51-b5b1-4b1f-af39-a9db2fa968d6/Images/Documentation/steprunner1.png" alt="steprunner1" class="fr-dib fr-bordered" style="width: 915px;"></p><ul><li>The error might indicate a different connectivity issue or a timeout. In these cases, we recommend you check the internal connectivity and ensure there's no firewall blocking the runner's access to the end user app.</li></ul><p><img src="https://cdn.document360.io/e159bc51-b5b1-4b1f-af39-a9db2fa968d6/Images/Documentation/steprunner2.png" alt="steprunner2" class="fr-dib fr-bordered" style="width: 915px;"></p><h2>Torq UI indications&nbsp;</h2><ol><li>Go to <strong>Integrations &gt; Runner</strong>.</li><li>Select <strong>Step Runner</strong>.</li><li>Find the relevant runner in the list.</li><li>Check the runner status. Unhealthy (red) means the runner isn't connected to the Torq cloud.</li><li>Check the <strong>Last Seen</strong> column to understand when was the connection lost.</li></ol><p><img src="https://cdn.document360.io/e159bc51-b5b1-4b1f-af39-a9db2fa968d6/Images/Documentation/steprunner3.png" alt="steprunner3" class="fr-dib fr-bordered" style="width: 915px;"></p><h2>Get more information</h2><p>To make sure the runner host has sufficient resources for the step execution you can check for CPU/memory usage spikes. This process differs according to whether the runner is docker-based or Kubernetes-based.</p><ol><li>Check your cloud provider health monitoring metrics for the runner host/cluster performance history.</li><li>Check the local runner host/cluster for resource-consumption-related errors, for example, with the dmesg/syslog commands. You can attach the list of errors if you end up contacting Torq support.</li><li>Run the command <code>docker ps</code> (Kubernetes: <code>kubectl --namespace torq get pods</code>) to see whether the runner is currently up and running.<img src="https://cdn.document360.io/e159bc51-b5b1-4b1f-af39-a9db2fa968d6/Images/Documentation/steprunner4.png" alt="steprunner4" class="fr-dib" style="width: 915px;"></li><li>Run the command <code>docker stats</code> (Kubernetes: <code>kubectl --namespace torq top</code>) to see the memory and CPU usage of the runner host.&nbsp;<img src="https://cdn.document360.io/e159bc51-b5b1-4b1f-af39-a9db2fa968d6/Images/Documentation/steprunner5.png" alt="steprunner5" class="fr-dib" style="width: 915px;"></li><li>&nbsp;Run the command <code>docker logs &lt;CONTAINER ID&gt; &gt;&amp; myFile.log</code> (Kubernetes: <code>kubectl --namespace torq logs &lt;pod id&gt; &gt;&amp; myFile.log</code>) to get additional information about the runner activity. The <code>&lt;CONTAINER ID&gt;</code>(Kubernetes: <code>&lt;pod id&gt;</code>) is available in the output of the previous commands. The output of the <code>docker logs</code> (Kubernetes: <code>kubectl --namespace torq logs</code>) command is added to a file that you can send to the support representative.&nbsp;</li></ol><h2>Conclusions&nbsp;</h2><p>Once you've checked the Torq UI indications and collected the additional information as described in the previous section you can decide what to do next.</p><ul><li>If the runner host CPU or memory usages are high you should allow more resources to the host/cluster that is running the runner and rerun the failing step.</li><li>If the runner is healthy (green), there are no connectivity issues with the runner itself. In this case, the problem may be in the internal connectivity with the service the runner is trying to communicate with (not related to Torq). We recommend you check the internal connectivity.</li><li>If the runner is not operational, we recommend you regenerate the runner install command and run it to deploy a new service. Contact your support representative with the extracted logs to understand the problem with the original malfunctioning service.</li><li>If there are no connectivity or resource limitation issues, contact your support representative with the extracted logs.</li></ul><section class="internal-notes" data-permitted-all-team-members="true" data-permitted-reader-groups="" data-permitted-security-groups=""><div class="internal-note-access-details"></div><div class="title">Icons</div><div class="content"><div class="content"><div class="content">Tips/note (blue)<img src="https://cdn.document360.io/e159bc51-b5b1-4b1f-af39-a9db2fa968d6/Images/Documentation/image-1674726837614.png" class="fr-fic fr-fil fr-dib" style="width: 40px;">Important (yellow)<img src="https://cdn.document360.io/e159bc51-b5b1-4b1f-af39-a9db2fa968d6/Images/Documentation/image-1674726587319.png" class="fr-fic fr-fil fr-dib" style="width: 40px;">Warning (red)<br><img src="https://cdn.document360.io/e159bc51-b5b1-4b1f-af39-a9db2fa968d6/Images/Documentation/image-1674726802592.png" class="fr-fic fr-fil fr-dib" style="width: 40px;"></div></div><br></div></section><section class="internal-notes" data-permitted-all-team-members="true" data-permitted-reader-groups="" data-permitted-security-groups=""><div class="internal-note-access-details"></div><div class="title">Meta title</div><p>How to TITLE OF ARTICLE using Torq</p><div class="content"><br></div></section><section class="internal-notes" data-permitted-all-team-members="true" data-permitted-reader-groups="" data-permitted-security-groups=""><div class="internal-note-access-details"></div><div class="title">Meta description</div><div class="content">Use Torq's cybersecurity platform to TITLE OF ARTICLE |&amp; FIGHT WHATEVER USE CASE THIS MEETS. Follow this guide to optimize and automate your security.<br><br><br></div></section>
