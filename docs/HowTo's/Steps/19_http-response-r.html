<!-- ## Metadata_Start
## title: HTTP response returned as a file
## original-url : https://learn.torq.io/docs/http-response-returned-as-file
## article-id : 8dd9fd1b-3ca1-4530-9c11-bebfce06adc1
## seo-title : How to get a HTTP response returned as a file in Torq
## description : Get Torq's HTTP steps' response returned to you as a file by following this guide. 
## category-type : html
## Metadata_End -->
<p>In some cases, you might want to get the response of an HTTP request step as a file, instead of directly to context. For example, when the step returns:</p><ul><li>An amount of <a href="/v1/docs/http-response-returned-as-file#large-output" rel="nofollow" translate="no">data that exceeds the output size limit</a>.</li><li>Non-textual, <a href="/v1/docs/http-response-returned-as-file#binary-content-image-pdf-file-executable-etc" rel="nofollow" translate="no">binary content</a>, such as an image, PDF, executable file, and so on.</li></ul><h2>Supported steps</h2><p>You can return the response as a file for the following steps:</p><ul><li><strong>Send an HTTP Request</strong> step</li><li>Any step that you can <strong>Switch to HTTP Mode</strong></li></ul><h2>Get the HTTP response as a file</h2><ol><li>&nbsp;In the step <strong>Properties</strong> tab, expand the <strong>Execution Options&nbsp;</strong>section.</li><li>&nbsp;Set the <strong>Return Response as File</strong> option to <strong>Yes</strong>.&nbsp;</li></ol><h2><img src="https://cdn.document360.io/e159bc51-b5b1-4b1f-af39-a9db2fa968d6/Images/Documentation/httprequestfile1.png" alt="httprequestfile1" class="fr-dib fr-bordered" style="width: 514px;"></h2><h2>HTTP request output</h2><p>The HTTP request output is a JSON object.</p><pre><code class="language-json" data-code-id="section-1674743708685" data-language="json">{
  "api_object": {
    "content_type": "application/json; charset=utf-8",
    "filename": "get",
    "hashes": {
      "md5": "15fff2b2e51d41a12247a0ea1639ee0f",
      "sha1": "9f22dac8bd5bb6aecf6c12cb88ee4cee1e18f465",
      "sha256": "94feff555d530e167f5cc0715760fce4c39baf258409b781ddd01fa9cf284f1a"
    },
    "size": 351,
    "url": "tqfile://steps/e1d63123-d938-46c3-bd5d-51ef9c26c123"
 	}
}</code></pre><p>Once you get the response for the Send an HTTP Request step, you can access its data by using the file URL as input for other steps, such as <strong>Run jq Command</strong> or <strong>Extract all using a regex group/pattern</strong>.</p><section class="infoBox"><div class="title"><meta charset="utf-8">&nbsp; <meta charset="utf-8"><span style="color: rgb(0, 106, 138); font-family: Nunito, sans-serif; font-size: 16px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 600; letter-spacing: 0.48px; orphans: 2; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(221, 247, 255); text-decoration-thickness: initial; text-decoration-style: initial; text-decoration-color: initial; display: inline !important; float: none;">üóíÔ∏è</span> Note</div><div class="content">To access a file URL with the format <span style="background-color: rgb(239, 239, 239); color: rgb(255, 0, 0);">tqfile://steps/XXXXXXXXX</span> in a subsequent step, use the <strong>file</strong> inline function: <span style="background-color: rgb(239, 239, 239); color: rgb(255, 0, 0);">{{file &lt;JSONPath to the URL&gt;}}</span>. For example: <span style="background-color: rgb(239, 239, 239); color: rgb(255, 0, 0);">{{ file $.send_an_http_request.api_object.url }}</span>. The <strong>file</strong> inline function isn't required if the file URL is a <a href="/v1/docs/use-files-in-a-workflow#important-to-know" rel="nofollow" translate="no">shareable link</a>.</div></section><section class="infoBox"><div class="title"><meta charset="utf-8"><span style="color: rgb(0, 106, 138); font-family: Nunito, sans-serif; font-size: 16px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 600; letter-spacing: 0.48px; orphans: 2; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(221, 247, 255); text-decoration-thickness: initial; text-decoration-style: initial; text-decoration-color: initial; display: inline !important; float: none;">üóíÔ∏è Note</span></div><div class="content">The response file is available for 24 hours.&nbsp;</div></section><p>The hash functions calculated for the file can be used to scan online threat databases to make sure the file is safe to use.</p><p>The <a href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Content-Type" rel="nofollow" translate="no">ContentType</a> is derived from the HTTP response header. The file content type, name, and size (in bytes) can be used as filter criteria in the following workflow steps.</p><h2>Shareable links</h2><p>File URLs with the format <span style="background-color: rgb(239, 239, 239); color: rgb(255, 0, 0);">tqfile://steps/XXXXXXXXX</span> can only be used in Torq steps and aren't shareable with third parties. To get a shareable link set the <strong>Shareable Link </strong>toggle to <strong>Yes</strong>. The <strong>Shareable Link</strong> toggle is only visible when the <strong>Return Response As File</strong> toggle is set to <strong>Yes</strong>.</p><p>A shareable link will have the format <span style="background-color: rgb(239, 239, 239); color: rgb(255, 0, 0);">https://link.torq.io/ ***dEjnLCXnv7</span> and it can be accessed directly in a subsequent step (doesn't require the <strong>file</strong> inline function).</p><p><img src="https://cdn.document360.io/e159bc51-b5b1-4b1f-af39-a9db2fa968d6/Images/Documentation/httprequestfile2.png" alt="httprequestfile2" class="fr-dib fr-bordered" style="width: 513px;"></p><h2>Binary content (image, PDF file, executable, etc.)</h2><p>Binary content should only be returned as a file. It's unusable otherwise.</p><p>In the following example, we attempted to get an image from the internet into context.</p><p><img src="https://cdn.document360.io/e159bc51-b5b1-4b1f-af39-a9db2fa968d6/Images/Documentation/httpsteprequestfile3.png" alt="httpsteprequestfile3" class="fr-dib fr-bordered" style="width: 570px;"><br></p><p>The output can't be used in a meaningful way.</p><p><img src="https://cdn.document360.io/e159bc51-b5b1-4b1f-af39-a9db2fa968d6/Images/Documentation/httpsteprequestfile4.png" alt="httpsteprequestfile4" class="fr-dib fr-bordered"></p><p>Instead, you can select to return the response as a file.</p><p><img src="https://cdn.document360.io/e159bc51-b5b1-4b1f-af39-a9db2fa968d6/Images/Documentation/httprequestfile1.png" alt="httprequestfile1" class="fr-dib fr-bordered" style="width: 514px;">The output is the response file object.</p><p><img src="https://cdn.document360.io/e159bc51-b5b1-4b1f-af39-a9db2fa968d6/Images/Documentation/httpsteprequest5.png" alt="httpsteprequest5" class="fr-dib fr-bordered"></p><p>You can pass the file URL to other steps in the workflow by using: <code>{{ file $.send_an_http_request.api_object.url }}</code></p><h2>Large output</h2><p>If the HTTP response exceeds the size limit, the step will fail or disrupt the workflow run. If your step fails for this reason or you expect the step to return a large response, you should set the <strong>Return Response as File</strong> parameter to <strong>Yes</strong>.</p><p><img src="https://cdn.document360.io/e159bc51-b5b1-4b1f-af39-a9db2fa968d6/Images/Documentation/httprequestfile1.png" alt="httprequestfile1" class="fr-dib fr-bordered" style="width: 514px;">The output is the response file object.</p><p><img src="https://cdn.document360.io/e159bc51-b5b1-4b1f-af39-a9db2fa968d6/Images/Documentation/httpsteprequestfile6.png" alt="httpsteprequestfile6" class="fr-dib fr-bordered">Content of the response file (reference)</p><pre><code class="language-json" data-code-id="section-1674744538154" data-language="json">{
   "args":{
      "foo1":"bar1",
      "foo2":"bar2"
   },
   "headers":{
      "x-forwarded-proto":"https",
      "x-forwarded-port":"443",
      "host":"postman-echo.com",
      "x-amzn-trace-id":"Root=1-628ca7cc-51450d6752429d686f2390d1",
      "accepted":"application/json; charset=utf-8",
      "user-agent":"TorqHTTPStep/4.0.0",
      "accept-encoding":"gzip"
   },
   "url":"https://postman-echo.com/get?foo1=bar1&amp;foo2=bar2"
}</code></pre><p>Below are examples of how you can extract information from the HTTP response file.&nbsp;</p><h3>Extract using regex</h3><p>The <strong>Extract all using a regex pattern</strong> step will return every match of the regular expression <code>foo*</code> in the HTTP response file. You can also use the <strong>Extract all using a regex group</strong> step.</p><p><img src="https://cdn.document360.io/e159bc51-b5b1-4b1f-af39-a9db2fa968d6/Images/Documentation/httpsteprequestfile7.png" alt="httpsteprequestfile7" class="fr-dib fr-bordered" style="width: 536px;"><br><img src="https://cdn.document360.io/e159bc51-b5b1-4b1f-af39-a9db2fa968d6/Images/Documentation/httpsteprequestfile8.png" alt="httpsteprequestfile8" class="fr-dib fr-bordered" style="width: 532px;"></p><h3>Extract using jq</h3><p>The <strong>Run jq Command</strong> step will return the value of the parameter <code>args</code> in the HTTP response file. To use JQ you need prior knowledge of the JSON structure.</p><p><img src="https://cdn.document360.io/e159bc51-b5b1-4b1f-af39-a9db2fa968d6/Images/Documentation/httpsteprequestfile9.png" alt="httpsteprequestfile9" class="fr-dib fr-bordered" style="width: 498px;"><br><img src="https://cdn.document360.io/e159bc51-b5b1-4b1f-af39-a9db2fa968d6/Images/Documentation/httpsteprequestfile10.png" alt="httpsteprequestfile10" class="fr-dib fr-bordered" style="width: 548px;"></p><section class="internal-notes" data-permitted-all-team-members="true" data-permitted-reader-groups="" data-permitted-security-groups=""><div class="internal-note-access-details"></div><div class="title">Icons</div><div class="content"><div class="content"><div class="content">Tips/note (blue)<img src="https://cdn.document360.io/e159bc51-b5b1-4b1f-af39-a9db2fa968d6/Images/Documentation/image-1674726837614.png" class="fr-fic fr-fil fr-dib" style="width: 40px;">Important (yellow)<img src="https://cdn.document360.io/e159bc51-b5b1-4b1f-af39-a9db2fa968d6/Images/Documentation/image-1674726587319.png" class="fr-fic fr-fil fr-dib" style="width: 40px;">Warning (red)<br><img src="https://cdn.document360.io/e159bc51-b5b1-4b1f-af39-a9db2fa968d6/Images/Documentation/image-1674726802592.png" class="fr-fic fr-fil fr-dib" style="width: 40px;"></div></div><br></div></section><section class="internal-notes" data-permitted-all-team-members="true" data-permitted-reader-groups="" data-permitted-security-groups=""><div class="internal-note-access-details"></div><div class="title">Meta title</div><p>How to TITLE OF ARTICLE using Torq</p><div class="content"><br></div></section><section class="internal-notes" data-permitted-all-team-members="true" data-permitted-reader-groups="" data-permitted-security-groups=""><div class="internal-note-access-details"></div><div class="title">Meta description</div><div class="content">Use Torq's cybersecurity platform to TITLE OF ARTICLE |&amp; FIGHT WHATEVER USE CASE THIS MEETS. Follow this guide to optimize and automate your security.<br><br><br></div></section>
